package just.fo.fun.dss;

import lombok.extern.slf4j.Slf4j;
import org.apache.lucene.analysis.en.EnglishAnalyzer;
import org.apache.lucene.queryParser.ParseException;
import org.apache.lucene.queryParser.QueryParser;
import org.apache.lucene.search.Query;
import org.apache.lucene.util.Version;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import ru.stachek66.nlp.mystem.holding.Factory;
import ru.stachek66.nlp.mystem.holding.MyStem;
import ru.stachek66.nlp.mystem.holding.MyStemApplicationException;
import ru.stachek66.nlp.mystem.holding.Request;
import ru.stachek66.nlp.mystem.model.Info;
import scala.Option;
import scala.collection.JavaConversions;

import java.io.File;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

@Transactional
@Service
@Slf4j
public class DssService {

    @Autowired
    private DssPositiveWordRepository dssPositiveWordRepository;

    @Autowired
    private DssNegativeWordRepository dssNegativeWordRepository;

    private static final EnglishAnalyzer en_an = new EnglishAnalyzer(Version.LUCENE_31);
    private static final QueryParser parser = new QueryParser(Version.LUCENE_31, "", en_an);

    private static final MyStem mystemAnalyzer = new Factory("-igd --eng-gr --format json --weight").newMyStem("3.0", Option.<File>empty()).get();



    public DssModel calculate(String source) throws MyStemApplicationException {


        //String source = "я понимать что он хотеть двигаться вперед и уважать это этот желание к сожаление многий многие боец в определенный определять момент забывать слово мы у они оставаться только я мы очень много многий и усердно усердный работать вместе мы многое многий достигать устанавливать множество рекорд и это этот быть работа команда сам боец менеджер промоутер тренер мы весь все приносить определенный определять жертва тратить сила и время который мочь бы проводить провожать с семья чтобы достигать успех тренер это этот человек который больше большой много больший все всего весь время временить проводить провожать с боксер сильный сильно другой член команда жертвовать свой семейный жизнь деньги деньга можно зарабатывать заработать но потратить время нельзя вернуть при пря это этот исторически исторический складываться что тренер наименее юридически юридический защищать член команда контракт защищать интерес промоутер менеджер но не тренер знать что в интернет писать разный вещь вещий но это этот делать гений гения который думать что они весь все знать и поэтому иметь право правый рассуждать о жизнь другой человек о который они совсем не осведомлять осведомленный и о переговоры на который они не присутствовать сказать санчес говорить о новый нова схема оплата предлагать он оно головкин головкина санчес не становиться называть конкретный цифра но отмечать что речь идти не о процент а о некий фиксированный фиксировать сумма и он оно его гонорар в итог получаться мало маленький малый общепринятый это этот быть было намного мало маленький малый чем что я получать рано ранний и намного мало маленький малый чем что традиционно традиционный получать тренер поэтому я решать отвечать отказ сказать санчес это этот быть было деловой решение с оба сторона мы оба взрослый человек мы не ссориться не кричать друг на друг каждый просто простой пойти свой свое путем путь по слово абель санчес ультиматум головкин головкина становиться для он оно полный неожиданность не быть было никакой признак то тот того что отношение между они ухудшаться и все всего весь полтора месяц назад они вместе участвовать в пресс-конференция на который быть было объявлять о подписание контракт с DAZN впервые после посол это этот они встречаться лишь пара пар день назад в четверг утро утром он зайти чтобы забирать свой вещь вещий мы пожимать пожинать рука я пожелать он оно удача и он уходить рассказывать тренер к сожаление когда молодой молодая человек достигать определенный определять уровень вокруг он оно появляться множество новый новое человек новый новое советчик я чувствовать что потерять не просто простой друг я как будто потерять сын потерять часть свой жизнь напоминать о прекращение сотрудничество который начинаться в год объявлять сам головкин свой свое решение он объяснять желание совершенствоваться в свой очередь санчес обвинять казахстанец в жадность и неблагодарность по он оно его слово головкин после посол подписание контракт со стриминговый? сервис DAZN решать сокращать жалование тренер специалист посчитать это этот предложение недостойный и отвечать отказ под руководство санчес головкин проводить бой в который одерживать победа из иза который нокаут один раз проигрывать и один поединок сводить вничью последний поединок становиться матч реванш против мексиканец сауль канеть? канелый? альварес ко в сентябрь год в который котор казахстанец проигрывать решение большинство судья и потерять титул WBC WBA Super и IBO в среднее средний вес потерпеть первый первое поражение в карьера карьер на ринг головкин вернуться июнь на арена арен Madison Square Garden в нью-йорк в бой с канадец стив роллс? ко поединок пройти проходить в промежуточный вес до фунт фунтовый готовиться к он оно нема казахстанец будет быть уже узкий узко уж не в Big Bear как это этот быть было ранее а в другой друг место";
        //String source = "ненавидеть цыган или справедливость восторжествовать ненавидеть весь всевать душа ненавидеть даже до то тот того как узнавать кто они и на что способный а когда пара пар год лет лета назад мой мыть мама на рынок начинать обрабатывать а затем вырывать клок волос волосы со слово домой домывать прийти гроб находить мой мыть ненависть преобрести преобредать преобреть преобретать статус всепоглощающий пусть сказать спасибо свой свое цыганский бог что я мень в этот момент не быть было рядом ряд ибо золотой зуб украшать бы тротуар это этот я вы уверять потом пот мой мыть одногруппница милый милая миловать и хороший девочка прозомбировать отбирать весь стипендия кошелек часы час даже пудра ублюдок доставать досталь и снова я мень рядом ряд не быть было ко я этот тварь подходить редко редкий но при пря первый первое же намек на приближение ко я они слышать только один фраза пойти пошлый нахуй отсюда иначе колено сломать и знать сразу как-то они сторона стороной идти слать но недавно происходить случай случать на который котор я отыгрываться и за мама и за одногруппница и за себя приезжать на переоформление авто становиться на парковка а там этот мразь ошиваться часто частый и что я видеть здоровый мужик лезть в барсетка и со стеклянный глаз отдавать цыганка плотный такой кошелек а сам будто под наркоз как под наркота я даже не думать взять бита бит я бейсболист просто простой подходить и всек всека по голень самый сам старший просто простой от душа душ душить хруст крик паника истерика истерик это этот быть было прекрасно прекрасный вы не подумать я не садюга и не гопник вполне приличный и добрый парень просто простой за весь все этот год накипать да и человек жалко жалкий так вот старший валяться на земля она ее подельница обещать я проблема а бледный мужик подымать свой кошелек с земля и тут тута до он оно доходить дохаживать что быть было далеко далекий тарантино бы разрывать пукан пукать пукивать от зависть мужик превращаться в халка халко он они их пиздить пиздило очень пиздить пиздило даже я со свой ненависть к он оно они нима аж ажа начинать начало он оно его останавливать везде кровища зуб мент красота с мужик до сей пора иногда на пиво ходить это этот он я так долг отдавать вывод подходить к вы сразу нахуй молниеносно молниеносный подходить к другой тоже самый сам помогать человек этот шавка как стая шакал один достаточно достаточный вырубать и весь все разбегаться и помнить помять это этот не женщина это этот цыган";
        //String source = "продолжение взрыв взрыть в Шымкенте  заправщик в реанимация полиция заводить дело девать после посол взрыв на заправка в Шымкенте  брать бер под личный контроль габидулла абдрахимов абдрахим о взрыв в Шымкенте  в сеть появляться видео взрыв который происходить в Шымкенте  передавать корреспондент Тengrinews  kz  пожар начинаться в на газохранилище в микрорайон Тассай  по данные давать данный акимата  город в связь связи с угроза взрыв по вызывать вызов быть быль направлять сила и средство средства в пожарный прибыль прибывать на место внимание на видео присутствовать ненормативный лексика устанавливать что на территория автогазозаправочной  станция компания мураз иметься два емкость для хранение газ газа по кубометр кубометровый каждый каждая опорожнять пустой гореть один емкость загораться остаток остатки газовый смесь смесить второй на защита охлаждаться также на территория АГЗС  взрываться два автоцистерна емкость семь кубометр кубометровый и два автоцистерна по кубометр кубометровый сообщать в ДЧС  Шымкента  по данные давать данный ведомство иметься один пострадавший пострадать ерлан анар анара год рождение сотрудник объект пожар локализовать в задействовать единица техника техник и человек личный личной состав внимание на видео присутствовать ненормативный лексика";
        //String source = "старший быть было младший двое брат погибать в дом под алматы алмат продолжение ребенок умирать от удар ток в Алматинской область в поселок Енбекшиарал Жамбылского район Алматинской область двое ребенок убивать ток погибать погибший родной родные брат братья старший быть было год лет лета младший восемь об это этот говориться в сюжет телеканал КТК трагедия происходить вечер вечером июнь во двор частный частное дом дома мальчик играть без присмотр взрослый младший упасть в колодец где находиться насос с оголять провод проводы старший тут тута же кинуться он оно его спасать но в итог оба получать удар ток и скончаться на место об этот эта страшный история сейчас говорить весь все село садиться очень хороший родитель родители у они большой больший и дружный семья а ребенок быть быль добрый и отзывчивый мы до сей пора не верить что так весь все происходить в школа старший учиться он оно его любить и уважать исполнительный мальчик быть мой мыть дочь с он оно они нима учиться рассказывать соседка в полиция отмечать что от экспертиза родитель родители отказываться давать данный факт зарегистрировать как несчастный случай случать и с наш нашивать сторона будет быть проводить необходимый в такой случай проверка заявлять официальный представитель департамент полиция Алматинской область серик Упиев районный власть готовый оказывать семья всяческий помощь погибший погибать ребенок похоронить в родной аул";
        //String source = "в кыргызстанском село сель Орок вблизи бишкек июнь происходить драка и погром во время праздничный намаз к окончание священный месяц рамазан после посол это этот человек задерживать один подросток попадать в больница сейчас он оно его состояние оцениваться как стабильный о то тот том тома что становиться причина конфликт не сообщаться во время беспорядок неизвестный неизвестная неизвестное выбивать окно примерно примерный в дом и поджигать два сеновал вскоре около сто человек выходить высылать на улица сообщаться что часть из иза они требовать выселять семья трое молодой молодые молодая человек участвовать в драка EMBED SHARE в село сель Орок под бишкек происходить погром и массовый арест EMBED SHARE The code has been copied to your clipboard iframe src https rus azattyq org embed player html type video frameborder scrolling no width height allowfullscreen iframe width px height px добавлять в свой Facebook добавлять в свой Twitter The URL has been copied to your clipboard https rus azattyq org a kyrgyzstan orok violence html No media source currently available на место прибыль прибывать несколько сотня сотенный сотрудник милиция и спецподразделение они дежурить в село сель и ночь ночью уже узкий узко уж июнь сообщать что ситуация стабилизироваться весь все задерживать задержанный отпускать среди они быть местный депутат но он оно его выпускать под домашний арест утро утром человек снова становиться сталь собираться около главный мечеть чтобы получать разъяснение о складываться ситуация у старейшина и местный руководство приходить прийти присылать к единый согласие единый согласие заключаться в то тот том тома что оба сторона не иметь какой-то претензия к друг друг а быть жить в согласие в мир мира миро и благополучие конфликт уже узкий узко уж улаживать но конфликт который быть с драка он будет быть расследоваться в рамка законодательство заявлять собираться эркинбек аширбай заместитель представитель правительство по чуйский чуйская область несмотря на то тот что житель вскоре расходиться милиционер по-прежнему оставаться в село сель по слово один из иза представитель милиция пока приказ покидать село садиться не поступать на фон погром в кыргызстан требовать отставка глава чуйский чуйская область туйгунаалы абдраимов абдраимова во время разговор с журналист на улица он отказываться отвечать на вопрос один из иза они по он оно его слово он оно не понравиться лицо журналистка между они происходить следующий следовать диалог я отвечать алый ала тоо весь все остальной остальное большой спасибо а другой вы не отвечать не отвечать почему лицо лицо ваш я неприятно неприятный только из-за это этот да вы только лицо журналист не нравиться почему некоторый некоторые журналист я нравиться вот вы например я нравиться обращаться к другой репортер НВ а почему именно она ее не нравиться ну не нравиться я же не виноватый EMBED SHARE в кыргызстан требовать отставка глава чуйский чуйская область он отказываться говорить с журналистка он оно не понравиться она ее лицо EMBED SHARE The code has been copied to your clipboard iframe src https rus azattyq org embed player html type video frameborder scrolling no width height allowfullscreen iframe width px height px добавлять в свой Facebook добавлять в свой Twitter The URL has been copied to your clipboard https rus azattyq org a kyrgyzstan orok violence html No media source currently available на следующий следовать день девать абдраимов абдраим отказываться говорить с пресса и закрываться в свой свое кабинет некоторый некоторые журналист посчитать что такой образ он нарушать закон и ограничивать доступ гражданин к общественный важный информация подобный поведение любой любая чиновник неважно неважный какой ранг недопустимо недопустимый понятно понятный что в село сель Орок быть сложный ситуация он мочь как-то более много корректно корректный себя повесть поводить повещать повести и сказать извинять я сейчас занятый занимать но к сожаление чиновник в последний время позволять себя себе себ так вести весть себя что они захотеть давать даль дали информация захотеть не давать даль дали информация говорить корреспондент kg татьяна кудрявцев кудрявцева поздно позже поздний чиновник все-таки выходить и объяснять свой реакция то тот тем тема что журналистка отвечать очень грубо грубый прокурорский тон премьер-министр кыргызстан обещать изучать инцидент и давать оценка поведение свой свое подчиненный подчинять абдраимов абдраим считаться один из иза главный главное кандидат на место новый новое глава правительство кыргызстан материал дарья тимофеева жибек Бегалиевой азат Ынтымакова корреспондент настоящий настоящее время временить";
        //String source = "компания SpaceX илона маска запускать грузовой корабль Dragon к международный космический станция трансляция старт утро утром май маять мая вестись на канал компания в Youtube запуск пройти проходить после посол серия отменять из-за технический неполадка неполадки пуск грузовой корабль доставлять на мкс ехать еда и оборудование для научный эксперимент первый ступень ракета носитель вернуться на автоматизированный автоматизировать баржа неподалеку от берег флорида флорид запуск ракета носитель Falcon называть тысячелетний сокол в честь корабль из иза звездный война становиться м успешный коммерческий пуск SpaceX к мкс";
        //String source = "космический грузовик долетать до мкс все всего весь за несколько час часы часов и уже узкий узко уж вечер вечером доставлять находиться на станция космонавт необходимый груз нур султан султана апр Sputnik ракета союз а с грузовой космический корабль прогресс МС успешно успешный стартовать с космодром байконур передавать риа новость старт ракета носитель союз ФГ с пилотировать корабль союз МС © SPUTNIK григорий сысоев сысой как казахстан получать выгода от космический комплекс Байтерек запущенный запускать в четверг апрель день днем космический корабль после посол полет по короткий краткий схема должный вечер вечером состыковываться с международный космический станция мкс прогресс совершать все всего весь два виток витка вокруг земля он оно его путь занимать все всего весь час минута обычно обычный же российский корабль добираться до станция по стандартный двухсуточный виток витка или по короткий шестичасовой четыре виток витка схема потрясать потрясающий снимок земля из иза космос прогресс МС доставлять на мкс система динамический освещение а также продукт вода вод топливо и сжатый сжимать сжинать газ газа после посол установка на модуль модула рассвет российский сегмент мкс система динамический освещение будет быть имитировать световой светова день девать от рассвет до закат как май маять мая в средний полоса россия корабль илона маска успешно успешный пристыковался к мкс читать далее https ru sputniknews kz space baikonur zapusk progress html";
        //String source = "одиннадцать год лет лета назад сентябрь год в сша происходить самый крупный в история человечество террористический акт в этот день девать в небоскреб всемирный торговый центр ВТЦ в нью-йорк и в здание пентагон врезаться три тереть самолет управляемый управлять террорист четвертый разбиваться в штат пенсильвания жертва теракт становиться сталь человек в то тот том тома число пожарный и полицейский одиннадцать год лет лета назад сентябрь год в сша происходить самый крупный в история человечество террористический акт в этот день девать группа из иза террорист захватить четыре коммерческий авиалайнер в здесь и далее время местный самолет Boeing авиакомпания American Airlines следовать из иза бостон в Лос Анджелес врезаться в северный башня всемирный торговый центр ВТЦ на остров манхеттен в нью йорк между и этаж на борт самолет быть пассажир и член экипаж в самолет Boeing авиакомпания United Airlines следовать из иза бостон в Лос Анджелес врезаться в южный башня ВТЦ между и этаж на борт самолет быть быль пассажир и девять член экипаж в самолет Boeing авиакомпания American Airlines следовать из иза вашингтон в Лос Анджелес врезаться в здание пентагон на борт самолет быть быль пассажир и шесть член экипаж в самолет Boeing авиакомпания United Airlines следовать из иза Ньюарка штат нью джерси в сан сана франциско упасть на поле пол пола поля поль в юго западный часть частить пенсильвания около город Шенксвилл в км от вашингтон на борт самолет быть быль пассажир и семь член экипаж в результат сильный пожар в обрушиваться южный а в северный башня ВТЦ в обрушиваться этажный здание комплекс центр международный торговля находиться в непосредственный близость от башня башенный ВТЦ в результат теракт погибать тот кто находиться в здание и в захватить самолет жертва теракт становиться сталь человек в то тот том тома число пожарный и полицейский в башня ВТЦ погибать человек в здание пентагон человек гражданский и военнослужащий точный цифра ущерб наносить теракт сентябрь неизвестный в сентябрь год президент сша джордж буш младший сообщать что ущерб от теракт сентябрь год составлять для сша по самый сам низкий низка оценка миллиард доллар долларовый ноябрь год в сша быть создавать независимый комиссия по расследование теракт сентябрь комиссия июль год комиссия обнародоваться итоговый доклад о расследование обстоятельство трагедия один из иза главный главное вывод страничный документ становиться признание то тот того что исполнитель теракт воспользоваться глубокий административный провал в работа правительство сша шестеро подозреваемый подозревать в причастность к теракт быть быль арестовывать в и год они проводить несколько год лет лета в тюрьма цру а в год быть быль доставлять в лагерь на американский база баз гуантанамо на куба куб в февраль год министерство оборона сша предъявлять шестеро заключать заключенный заключенная обвинение в убийство и совершение военный преступление в рамка расследование теракт сентябрь обвинение быть быль выдвигать против халида халид шейх мохаммед который в соответствие с доклад комиссия являться центральный фигура в подготовка теракт в сша сентябрь год уроженец йемен Рамзи Биналшиба который по версия следствие заниматься материально материальный технический обеспечение деятельность ячейка аль аля каида каид в гамбург мохаммед аль аля Кахтани который сентябрь год должный быть становиться стать еще один двадцатый угонщик четыре американский самолет племянник халида халид шейх мохаммед выходец из иза кувейт али аля абдул абдула азиз азиза али аля и саудовец мустафа мустаф ахмед Хавсави и валида валид бин Атташ как выяснять выяснивать следствие трое троя трой последний быть быль у халида халид шейх мохаммед на подхват заниматься черновой чернова работа по подготовка спланировать пакистанец теракт в май мая год пентагон снимать обвинение с мохаммед аль аля Кахтани после посол то тот того как президент барак обама в январь год распоряжаться приостанавливать весь деятельность военный прокуратура в тюрьма гуантанамо и пообещать закрывать учреждение военный ведомство приходиться придтись отказываться от обвинение однако это этот обещание президент так и оставаться невыполненный не получать поддержка в конгресс глава государство в начало март марта год давать указание возобновлять военный суд в отношение удерживать в тюрьма на гуантанамо подозреваемый подозревать в терроризм в начало апрель год генпрокурор сша эрик эрика Холдер подтвердить подтверждать что обвиняемый обвинять халид халида шейх мохаммед и еще четверо обвиняемый обвинять обвиняемая по дело сентябрь представать не перед гражданский суд сша а перед специальный военный комиссия на база баз гуантанамо май маять мая год военный прокуратура сша снова предъявлять обвинение в причастность к организация теракт сентябрь год пятеро подозреваемый подозревать в то тот том тома число халида халид шейх мохаммед май маять мая год военный трибунал предъявлять официальный обвинение пятеро подозреваемый подозревать в причастность к организация теракт сентябрь в сша подозреваемый подозревать быть быль предъявлять обвинение в организация заговор нападение на мирный житель намеренный намеривать причинение физический ущерб убийство нарушение закон война причинение разрушение угон самолет и терроризм весь все пятеро обвиняемый обвинять обвиняемая отказываться отвечать признавать ли они себя виновный предполагать предполагаемый террорист игнорировать суд в течение все всего весь заседание в самый сам начало они снимать наушники наушник в который транслироваться синхронный перевод происходить в зал зала зало суд судно на арабский язык вставать на колено и молиться поздно поздний двое из иза они доставать досталь и становиться сталь листать журнал Economist когда в зал зала зало суд судно быть приглашать переводчик чтобы переводить перевести вопрос судья на арабский язык обвиняемый обвинять обвиняемая оставаться безучастный к происходить сторона защита от комментарий отказываться ранее адвокат заявлять что давать данный заседание только начало начинать длительный судебный процесс на завершение который уходить год если военный трибунал признавать подсудимый подсудимая виновный он оно они има грозить смертный казнь материал подготовить на основа информация риа новость и открытый открывать источник";
        //String source = "нил нила армстронг становиться первый первое человек на луна лунь еще в год а художественный фильм о он оно немой нема выходить только в октябрь режиссер дэмьен Шазелл мочь выбирать любой люба любая жанр но снимать свой свое человек на луна лунь как семейный драма драм потому что именно она побуждать побудить армстронг отправляться в космос рассказывать о он оно его жизнь и о то тот том тома какой роль роля в полет полоть на луна сыграть личный личной трагедия астронавт нил нила Олден армстронг рождаться родиться август августа год в городок Уапаконета в штат огайо он оно его отец быть аудитор поэтому семья почти почесть почтить каждый год переезжать с место на место пока в не оседать наконец в Уапаконете до сей пора весь все интересный что можно сказать об это этот город там рождаться родиться и жить жила жило нил нила армстронг первый человек побывать на луна лунь из иза провинциальный мальчишка мочь может вырастать выращивать национальный герой гера даже когда родитель родители нет до он оно дело девать юный армстронг записываться в бойскаут где он оно прививать строгий моральный принцип там же он усваивать поговорка в здоровый тело теле здоровый дух и становиться настоящий настоящее патриот нил нила армстронг в детство оканчивать школа нил нила поступать на факультет авиационный промышленность в университет пердь в индиана он становиться второй второе человек в семья кто поступать в высокий учебный заведение обучение стоить дорого дорогой у армстронг деньги на он оно быть было на помощь приходить прийти пришлый государство нила нил предлагать оплачивать весь все четыре год в университет с условие что после посол первый первое два год лет лета он на три тереть год уходить служить в армия военный служба армстронг как закаленный закалять бойскаут совсем не пугать пугало в армия он становиться летчик испытатель потому что с детство мечтать летать он оно его отправлять на корейский война где он чудо чудом оставаться живой жить он оно его истребитель однажды подбивать отслуживать в армия и оканчивать университет в год армстронг жениться на дженет шерон в семья скоро скорый появляться трое троя трой ребенок мальчик марк марка и эрик эрика и девочка карен еще ребенок она умирать от рак рака и если верить фильм человек на луна лунь именно она ее смерть повлиять на дальнейший жизнь армстронг он с голова уходить в работа и тренировка нил нила с жена и ребенок год почему вообще среди множество кандидат начальство выбирать именно армстронг он быть отличный профессионал но такой быть было немало немалый дело девать в то тот том тома что армстронг в отличие от другой не быть эгоист и уметь умелый уметать справляться со свой эмоция ведь даже смерть дочь не заставлять он оно его прекращать тренировочный полет коллега за спина у нила нил называть он оно его ледяной капитан настолько он быть с они холодный теперь никто не рассказывать что чего в этот эта холодность быть было больше большой много больший профессионализм или психологический травма фильм человек на луна лунь вообще трактовать полет полоть как единственный удача в цепочка ошибка провал и смерть кроме дочь армстронг потерять несколько нескольким близкий близкие друг друзь нил нила армстронг проходить подготовка год но в реальный жизнь с себя на луна вместо браслет дочь армстронг взять деталь от самый сам первый первое самолет брат райт это этот быть маленький шаг для человек но гигантский скачок для все всего весь человечество и последний для армстронг быть было не менее мало меней а то тот и более много значить значимый под человечество наверняка подразумеваться один конкретный нация потому что патриот нил нила армстронг твердо твердый знать чей сторона он занимать в холодный холодная война но и почти почесть почтить в год лет лета армстронг в что-то оставаться то тот тем тема же бойскаут какой быть в Уапаконете и речь не столько о он оно его принцип сколько скольким об иногда мальчишеский поведение скажем сказать если бы не помощь друг нил нила бы вообще не попадать в программа полет на луна заявление он отправлять поздно позже поздний чем что нужно нужный и по справедливость он оно его вообще не должный быть быль рассматривать как кандидат перед полет нил нила разговаривать с бабушка и пообещать не ступать на луна если тот показываться небезопасный проводить два с половина час на луна лунь нил нила армстронг не становиться другой человек в год миллион зритель по весь все мир мира миро смотреть на армстронг по телевизор а уже узкий узко уж в имя нил нила армстронг согласно согласный опрос помнить только американец кажется казаться в ссср астронавт быть даже популярный популярно чем что у себя на родина родино родин в то тот том тома же год он приезжать в ленинград и в москва а человек выстраиваться в очередь чтобы он оно его увидеть армстронг на луна лунь до конец жизнь армстронг не переставать попадать в сводка новость то тот он называть себя деист то тот быть есть признавать существование бог и весь все научный сообщество всполошиться как это этот человек быть там видеть космический пустота а в бог все-таки верить или вот новость простой просто и интересно интересный нил нила армстронг отправляться на северный полюс чтобы на этот раз увидеть он оно его с земля среди все всего весь это этот шум как-то затериваться сообщение о то тот том тома что спустя год лет лета брак распадаться семейство армстронг у национальный герой пример для подражание и кумир мальчишка все всего весь мир мира миро нила нил армстронг быть было нелегкий детство тяжелый семейный жизнь и возможно возможный самый сложный работа в мир мира миро он умирать из-за проблема с сердце в год а он оно его семья в х армстронг жениться повторно повторный выступать с обращение когда вечер вечером вы выходить на улица и увидеть луна подумать о нила нил армстронг и подмигивать он оно фильм фильмовый не только про полет полоть на луна аполлон рона рон ховард аполлон единственный из иза летать на луна пилотировать корабль на борт который происходить серьезный авария и один из иза главный главное неудача в история НАСА одноименный и уже узкий узко уж классический фильм с том Хэнксом один из иза наиболее удачный картина картин о космос в история голливуд и хороший возможность услышать с экран фраза хьюстон у мы проблема кадр из иза фильм аполлон парень что надо филип Кауфмана незаслуженно незаслуженный позабывать фильм об история американский астронавтика о то тот том тома как несколько простой парень проходить пройти через множество сложность на земля все-таки улетать в космос ребенок мочь может показываться скучноватый а вот для родитель родители в самый раз кадр из иза фильм парень что надо салют клим Шипенко неожиданный пример примирать примереть нестыдного российский блокбастер создавать по весь все голливудский лекало салют все-таки утверждать сила сило русский дух и для укрепление чувство патриотизм делать гораздо горазд больше большой много больший многий многие чиновник кадр из иза фильм салют игра эндер гэвин худой худо фантастический боевик про мальчик который становиться полководец целый флотилия космический корабль довольно довольный дурацкий по мнение большинство взрослый он вполне мочь может становиться стать любимый любить любимая фильм весь все интересоваться космос ребенок и подросток подростковый кадр из иза фильм игра эндер Интерстеллар кристофер нолан почти почесть почтить трехчасовой фильм кристофер нолан он выглядеть эпичный чем что начало начинать и весь трилогия о Бэтмене вместе взять но при пря это этот рассказывать главный главное образ о семейный ценность будить ребенок к начало второй второе час когда начинаться путешествие по разный планета планет кадр из иза фильм Интерстеллар стража страж галактика джеймс ганна ганн сюжет самый сам яркий смешноого и просто простой самый сам самый сам фильм от Marvel разворачиваться как раз в космос хотя хотеть с настоящий настоящее этот заполонять супергероями мир миро мира иметь конечно конечный очень мало малый маленький общий зато там быть есть говорить говорящий в оринале голос брэдли купер енот ракета кадр из иза фильм стража страж галактика ВАЛЛ и эндрю стэнтон молчаливый как сам космос мультфильм Pixar про одинокий робот мусорщик на опустеть земля шедевр вместе с который популярность студия с лампа в логотип устремляться куда-то к звезда кадр из иза мультфильм ВАЛЛ и мы не мочь жить без космос константин Бронзита российский короткометражный мультфильм о два друг готовиться к полет в космос несмотря на общий скромность пара пар год лет лета назад номинировался на оскар кадр из иза мультфильм мы не мочь жить без космос тайна тайный третий третья планета планет роман романа качанов качанова любимый любить с детство мультфильм о девочка алиса алисе Громозеке и говорун который кажется казаться ничуть не устаревать устарелый за почти почесть почтить сорок сорока год лет лета с момент выход кто будет быть больше большой много больший довольный он оно его просмотр ребенок или родитель родители большой вопрос кадр из иза мультфильм тайна тайный третий третья планета планет земля в иллюминатор константин мурашев мурашева Документалка от мкс фиксировать будни будний наш космонавт они рассказывать как есть мыться и отмечать новый год на орбита орбит а главное главный показывать земля из иза иллюминатор интересный интересно многий многие художественный фильм фильмовый";
        //String source = "на пляж в сан-франциско находить насылать мертвый серый кит центр морской млекопитающее проводить анализ и устанавливать причина гибель столкновение с судно судный ученый предупреждать что человек не следовать приближаться к мертвый кит так это этот опасный опасно для здоровье к то тот тома том же запрещать закон это этот уже узкий узко уж девятый девятая по счет туша туш тушить кит находить с март марта в область залив сан-франциско в центр морской млекопитающее говорить говорят что кит погибать от недоедание и столкновение с судно судный эксперт также отмечать что в это этот год серый кит мигрировать из иза мексика в аляска находиться в плохой состояние они не находить нахаживать достаточно достаточный еда из-за потепление океан";
        //String source = "омаха бич рассвет и дань даня уважение сотня человек как военный так и гражданский со все всего весь мир мира миро встречать рассвет на пляж омаха бич в нормандия отдавать дань даня уважение то тот тем тема кто погибать погиб погиба здесь июнь год на первый взгляд спокойный синий вода воды вод ла-манш год лет лета назад в этот день девать быть быль окрашивать в красный свет света более много человек погибать вдвое больше большой много больший быть быль ранить раненый во время высадка высадок союзник на омаха бич и в последующий сражение с нацистский войско войска во франция франций июнь проходить серия торжественный мероприятие посвящать один из иза главный главное событие второй втора мировой мировая мирова война почти почесть почтить во весь все принимать участие немногие немногий оставаться в живой ветеран";

        boolean isEnglishSource = true;
        List<String> words = null;

        if(isEnglishSource) {
            words = normalizeEnglish(source);
        } else {
            words =  normalizeRussian(source);
        }

        //String[] words = normalizedSource.toLowerCase().split("\\s+");

        LinkedList<String> positiveSelectedWords = new LinkedList<>();
        LinkedList<String> negativeSelectedWords = new LinkedList<>();

        for (int i = 0; i < words.size(); i++) {

            if (dssPositiveWordRepository.contains(words.get(i))) {
                positiveSelectedWords.add(words.get(i));
            }

            if (dssNegativeWordRepository.contains(words.get(i))) {
                negativeSelectedWords.add(words.get(i));
//
//                if ("не".equals(words[i]) || "без".equals(words[i]) || "бы".equals(words[i])) {
//
//                    if (words.length > i + 1 && dssPositiveWordRepository.contains(words[i + 1])) {
//                        positiveSelectedWords.removeLast();
//                    }
//                }

            }

        }


        double negativePercent = negativeSelectedWords.size() / (double) (negativeSelectedWords.size() + positiveSelectedWords.size());
        double positivePercent = positiveSelectedWords.size() / (double) (negativeSelectedWords.size() + positiveSelectedWords.size());

        if (Double.isNaN(negativePercent)){
            negativePercent = 0;
        }
        if (Double.isNaN(positivePercent)){
            positivePercent = 0;
        }

        return new DssModel(negativeSelectedWords, positiveSelectedWords, negativeSelectedWords.size(),
                positiveSelectedWords.size(), negativePercent, positivePercent, words);

    }


    private static List<String> normalizeRussian(final String text) throws MyStemApplicationException {

        final Iterable<Info> result = JavaConversions.asJavaIterable(
                mystemAnalyzer.analyze(Request.apply(text))
                        .info()
                        .toIterable()
        );

        List<String> res = new ArrayList<>();
        for (final Info info : result) {
            Option<String> lex = info.lex();

            if (lex.nonEmpty()) {
                res.add(lex.get());
            }
        }

        return res;
    }

    private static List<String> normalizeEnglish(final String text) throws MyStemApplicationException {

        List<String> res = new ArrayList<>();

        String[] words = text.toLowerCase().split("\\s+");

        for(String word : words) {
            try {
                Query parse = parser.parse(word);
                res.add(parse.toString());
            } catch (ParseException e) {
                e.printStackTrace();
            }
        }

        return res;
    }


    public Integer deletePositiveWord(String word) {
        return dssPositiveWordRepository.setIsDeletedTrue(word);
    }

    public Integer deleteNegativeWord(String word) {
        return dssNegativeWordRepository.setIsDeletedTrue(word);
    }


    public DssPositiveWord insertPositiveWord(String word) {
        return dssPositiveWordRepository.save(new DssPositiveWord(word));
    }

    public DssNegativeWord insertNegativeWord(String word) {
        return dssNegativeWordRepository.save(new DssNegativeWord(word));
    }
}
